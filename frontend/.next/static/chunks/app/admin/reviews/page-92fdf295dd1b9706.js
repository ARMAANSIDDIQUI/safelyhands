(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6160],{2676:(e,t,s)=>{"use strict";s.d(t,{E1:()=>a,gf:()=>o,q7:()=>i,wz:()=>n});let r="auth_session",a=(e,t)=>{let s={user:{_id:e._id,name:e.name,email:e.email,role:e.role||"user",phone:e.phone,isGoogleUser:e.isGoogleUser,profilePicture:e.profilePicture},token:t,expiresAt:Date.now()+2592e6};localStorage.setItem(r,JSON.stringify(s))},l=()=>{try{let e=localStorage.getItem(r);if(!e)return null;let t=JSON.parse(e);if(t.expiresAt&&Date.now()>t.expiresAt)return i(),null;return t}catch(e){return console.error("Error reading session:",e),null}},o=()=>{let e=l();return(null==e?void 0:e.token)||null},n=()=>{let e=l();return(null==e?void 0:e.user)||null},i=()=>{localStorage.removeItem(r),localStorage.removeItem("user"),localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},13119:(e,t,s)=>{"use strict";s.d(t,{A:()=>d,O:()=>i});var r=s(95155),a=s(12115),l=s(20063),o=s(2676);let n=(0,a.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),i=e=>{let{children:t}=e,[s,i]=(0,a.useState)(null),[d,c]=(0,a.useState)(!0),u=(0,l.useRouter)();(0,a.useEffect)(()=>{let e=(0,o.wz)(),t=(0,o.gf)();e&&t?(console.log("AuthContext: Restoring session. Token present:",!!t),i({...e,token:t})):console.log("AuthContext: No session found in localStorage"),c(!1)},[]);let m=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),r=await s.json();if(!s.ok)throw Error(r.message||"Login failed");return(0,o.E1)(r,r.token),console.log("AuthContext: Login successful. Token:",r.token?"Yes":"No"),i(r),"worker"===r.role?u.push("/worker/dashboard"):"admin"===r.role?u.push("/admin"):u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},p=async(e,t,s,r)=>{try{let a=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,phone:s,password:r})}),l=await a.json();if(!a.ok)throw Error(l.message||"Signup failed");return{success:!0,message:l.message,email:l.email}}catch(e){return{success:!1,message:e.message}}},f=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:t})}),r=await s.json();if(!s.ok)throw Error(r.message||"Verification failed");return(0,o.E1)(r,r.token),console.log("AuthContext: Email verified. Token:",r.token?"Yes":"No"),i(r),u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,r.jsx)(n.Provider,{value:{user:s,setUser:i,loading:d,login:m,register:p,verifyEmail:f,logout:()=>{(0,o.q7)(),i(null),u.push("/login")}},children:t})},d=()=>(0,a.useContext)(n)},16485:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},20508:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},29633:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]])},37586:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},39347:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},42529:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},45781:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});var r=s(95155);s(12115);var a=s(83101),l=s(64269);let o=(0,a.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)(o({variant:s}),t),...a})}},52056:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},57356:(e,t,s)=>{"use strict";s.d(t,{$:()=>d});var r=s(95155),a=s(12115),l=s(32467),o=s(83101),n=s(64269);let i=(0,o.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:s,variant:a,size:o,asChild:d=!1,...c}=e,u=d?l.DX:"button";return(0,r.jsx)(u,{className:(0,n.cn)(i({variant:a,size:o,className:s})),ref:t,...c})});d.displayName="Button"},64269:(e,t,s)=>{"use strict";s.d(t,{Y:()=>o,cn:()=>l});var r=s(2821),a=s(75889);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}function o(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}},78874:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},83669:(e,t,s)=>{Promise.resolve().then(s.bind(s,97635))},90758:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>i,Zp:()=>o,aR:()=>n,wL:()=>u});var r=s(95155),a=s(12115),l=s(64269);let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...a})});o.displayName="Card";let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...a})});n.displayName="CardHeader";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",s),...a})});i.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...a})});c.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},94128:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>u,Es:()=>p,L3:()=>f,c7:()=>m,lG:()=>i,rr:()=>h});var r=s(95155),a=s(12115),l=s(93409),o=s(65229),n=s(64269);let i=l.bL;l.l9;let d=l.ZL;l.bm;let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.hJ,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a})});c.displayName=l.hJ.displayName;let u=a.forwardRef((e,t)=>{let{className:s,children:a,...i}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(c,{}),(0,r.jsxs)(l.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...i,children:[a,(0,r.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=l.UC.displayName;let m=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};m.displayName="DialogHeader";let p=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};p.displayName="DialogFooter";let f=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",s),...a})});f.displayName=l.hE.displayName;let h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});h.displayName=l.VY.displayName},97635:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var r=s(95155),a=s(12115),l=s(13119),o=s(35299),n=s(37586),i=s(20508),d=s(29633),c=s(16485),u=s(39347),m=s(78874),p=s(42529),f=s(18720),h=s(57356),x=s(90758),g=s(45781),v=s(98069),y=s(24986);function b(){let{user:e,loading:t}=(0,l.A)(),[s,b]=(0,a.useState)([]),[w,j]=(0,a.useState)([]),[N,A]=(0,a.useState)(!0),[k,C]=(0,a.useState)(!1),[z,S]=(0,a.useState)(!1),[E,R]=(0,a.useState)({id:null,status:null}),[T,D]=(0,a.useState)("all"),M=async()=>{try{let t=await fetch("".concat("http://localhost:5000/api","/reviews/admin"),{headers:{Authorization:"Bearer ".concat(null==e?void 0:e.token)}}),s=await t.json();Array.isArray(s)&&(b(s),O(s,T))}catch(e){f.o.error("Failed to fetch reviews")}finally{A(!1)}},O=(e,t)=>{"all"===t?j(e):"approved"===t?j(e.filter(e=>!0===e.isApproved)):"declined"===t?j(e.filter(e=>!1===e.isApproved)):"pending"===t&&j(e.filter(e=>void 0===e.isApproved||null===e.isApproved))};(0,a.useEffect)(()=>{!t&&(null==e?void 0:e.token)&&M()},[e,t]),(0,a.useEffect)(()=>{O(s,T)},[T,s]);let P=async(t,s)=>{C(!0);try{(await fetch("".concat("http://localhost:5000/api","/reviews/").concat(t,"/approval"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==e?void 0:e.token)},body:JSON.stringify({isApproved:s})})).ok?(f.o.success(s?"Review approved":"Review declined"),M()):f.o.error("Failed to update review status")}catch(e){f.o.error("Error updating review")}finally{C(!1),S(!1)}},_=(e,t)=>{R({id:e,status:t}),S(!0)};return N?(0,r.jsx)("div",{className:"flex h-96 items-center justify-center",children:(0,r.jsx)(o.A,{className:"animate-spin text-blue-600"})}):(0,r.jsxs)("div",{className:"space-y-8 p-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-display font-bold text-slate-900",children:"Review Moderation"}),(0,r.jsx)("p",{className:"text-slate-500",children:"Approve or decline customer reviews before they go public."})]}),(0,r.jsx)("div",{className:"flex bg-slate-100 p-1 rounded-xl border border-slate-200",children:["all","pending","approved","declined"].map(e=>(0,r.jsx)("button",{onClick:()=>D(e),className:"px-4 py-2 rounded-lg text-sm font-bold capitalize transition-all ".concat(T===e?"bg-white text-blue-600 shadow-sm":"text-slate-500 hover:text-slate-700"),children:e},e))})]}),0===w.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-20 text-center text-slate-500 bg-white rounded-2xl border border-slate-100 shadow-sm",children:[(0,r.jsx)(n.A,{className:"h-16 w-16 mb-4 opacity-10"}),(0,r.jsxs)("h3",{className:"text-xl font-semibold text-slate-900 capitalize",children:["No ","all"!==T?T:""," Reviews"]}),(0,r.jsx)("p",{className:"max-w-xs mx-auto",children:"There are no reviews matching the current filter."})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:w.map(e=>{var t,s,a,l,o,f;return(0,r.jsxs)(x.Zp,{className:"overflow-hidden border-slate-200 hover:border-blue-200 transition-colors shadow-sm",children:[(0,r.jsx)(x.aR,{className:"pb-3 bg-slate-50/50",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"relative w-10 h-10 rounded-full overflow-hidden border-2 border-white shadow-sm bg-blue-100 flex items-center justify-center text-blue-600 font-bold",children:(null==(t=e.user)?void 0:t.profilePicture)?(0,r.jsx)("img",{src:e.user.profilePicture,alt:e.user.name,className:"w-full h-full object-cover"}):(null==(a=e.user)||null==(s=a.name)?void 0:s.charAt(0).toUpperCase())||"U"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(x.ZB,{className:"text-sm font-bold text-slate-800",children:(null==(l=e.user)?void 0:l.name)||"Unknown User"}),(0,r.jsxs)(x.BT,{className:"text-[10px] flex items-center gap-1 font-medium",children:[(0,r.jsx)(i.A,{size:10})," ",(null==(o=e.user)?void 0:o.email)||"No email"]})]})]}),(0,r.jsx)(g.E,{variant:"secondary",className:"capitalize px-2 py-0.5 text-[10px] font-bold ".concat(!0===e.isApproved?"bg-green-100 text-green-700":!1===e.isApproved?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:!0===e.isApproved?"Approved":!1===e.isApproved?"Declined":"Pending"})]})}),(0,r.jsxs)(x.Wu,{className:"py-5 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(d.A,{size:12,className:"text-blue-500"}),(0,r.jsx)("span",{className:"font-bold text-slate-700",children:(null==(f=e.worker)?void 0:f.name)||"Deleted Worker"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 font-medium",children:[(0,r.jsx)(c.A,{size:12}),(0,y.GP)(new Date(e.createdAt),"MMM d, yyyy")]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[[void 0,void 0,void 0,void 0,void 0].map((t,s)=>(0,r.jsx)(u.A,{size:14,className:s<e.rating?"text-yellow-400 fill-yellow-400":"text-slate-300"},s)),(0,r.jsxs)("span",{className:"ml-2 font-black text-slate-900 text-sm",children:[e.rating,".0"]})]}),(0,r.jsxs)("div",{className:"p-4 bg-slate-50 rounded-2xl border border-slate-100 italic text-slate-700 text-sm leading-relaxed relative font-medium",children:[(0,r.jsx)(n.A,{className:"absolute -top-2 -left-2 text-slate-200",size:18}),'"',e.comment,'"']})]}),(0,r.jsx)(x.wL,{className:"flex justify-end gap-3 border-t bg-white pt-4",children:!0===e.isApproved?(0,r.jsxs)(h.$,{variant:"outline",size:"sm",className:"text-red-600 border-red-200 hover:bg-red-50 text-xs font-bold rounded-lg",onClick:()=>_(e._id,!1),disabled:k,children:[(0,r.jsx)(m.A,{className:"mr-2 h-3.5 w-3.5"})," Decline"]}):!1===e.isApproved?(0,r.jsxs)(h.$,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white text-xs font-bold rounded-lg shadow-lg shadow-green-100",onClick:()=>_(e._id,!0),disabled:k,children:[(0,r.jsx)(p.A,{className:"mr-2 h-3.5 w-3.5"})," Approve"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(h.$,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-50 text-xs font-bold rounded-lg",onClick:()=>_(e._id,!1),disabled:k,children:[(0,r.jsx)(m.A,{className:"mr-2 h-3.5 w-3.5"})," Decline"]}),(0,r.jsxs)(h.$,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white text-xs font-bold rounded-lg shadow-lg shadow-green-100",onClick:()=>_(e._id,!0),disabled:k,children:[(0,r.jsx)(p.A,{className:"mr-2 h-3.5 w-3.5"})," Approve"]})]})})]},e._id)})}),(0,r.jsx)(v.A,{open:z,onOpenChange:S,onConfirm:()=>P(E.id,E.status),title:E.status?"Approve Review?":"Decline Review?",description:E.status?"This review will become public and influence the worker's average rating.":"This review will be hidden from the public site.",confirmText:E.status?"Approve":"Decline",loading:k})]})}},98069:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(95155);s(12115);var a=s(94128),l=s(57356),o=s(52056);function n(e){let{open:t,onOpenChange:s,onConfirm:n,title:i="Are you sure?",description:d="This action cannot be undone.",confirmText:c="Confirm",cancelText:u="Cancel",variant:m="destructive",loading:p=!1}=e;return(0,r.jsx)(a.lG,{open:t,onOpenChange:s,children:(0,r.jsxs)(a.Cf,{className:"sm:max-w-[425px]",children:[(0,r.jsxs)(a.c7,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["destructive"===m&&(0,r.jsx)(o.A,{className:"h-5 w-5 text-red-500"}),(0,r.jsx)(a.L3,{children:i})]}),(0,r.jsx)(a.rr,{className:"pt-2",children:d})]}),(0,r.jsxs)(a.Es,{className:"mt-4",children:[(0,r.jsx)(l.$,{variant:"outline",onClick:()=>s(!1),disabled:p,children:u}),(0,r.jsx)(l.$,{variant:m,onClick:n,disabled:p,children:p?"Processing...":c})]})]})})}}},e=>{e.O(0,[4230,4909,5391,1903,5207,3461,8441,1255,7358],()=>e(e.s=83669)),_N_E=e.O()}]);