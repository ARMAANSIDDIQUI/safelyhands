(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8733],{2676:(e,t,s)=>{"use strict";s.d(t,{E1:()=>r,gf:()=>n,q7:()=>i,wz:()=>o});let a="auth_session",r=(e,t)=>{let s={user:{_id:e._id,name:e.name,email:e.email,role:e.role||"user",phone:e.phone,isGoogleUser:e.isGoogleUser,profilePicture:e.profilePicture},token:t,expiresAt:Date.now()+2592e6};localStorage.setItem(a,JSON.stringify(s))},l=()=>{try{let e=localStorage.getItem(a);if(!e)return null;let t=JSON.parse(e);if(t.expiresAt&&Date.now()>t.expiresAt)return i(),null;return t}catch(e){return console.error("Error reading session:",e),null}},n=()=>{let e=l();return(null==e?void 0:e.token)||null},o=()=>{let e=l();return(null==e?void 0:e.user)||null},i=()=>{localStorage.removeItem(a),localStorage.removeItem("user"),localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},13098:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(95155),r=s(12115),l=s(13119),n=s(35299),o=s(91169),i=s(23664),c=s(69141),d=s(76907),u=s(16485),h=s(18720),m=s(2676),x=s(64269);function p(){let{user:e}=(0,l.A)(),[t,s]=(0,r.useState)([]),[p,f]=(0,r.useState)(!0),g=async()=>{try{let e=(0,m.gf)(),t=await fetch("".concat("http://localhost:5000/api","/auth/users"),{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();t.ok?s(a):h.o.error(a.message||"Failed to fetch users")}catch(e){h.o.error("Error loading users")}finally{f(!1)}};return((0,r.useEffect)(()=>{e&&g()},[e]),p)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsx)(n.A,{className:"w-8 h-8 animate-spin text-blue-500"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-display font-bold text-slate-900",children:"Registered Users"}),(0,a.jsx)("p",{className:"text-slate-500 mt-2",children:"View and manage all registered customers and staff."})]}),(0,a.jsxs)("div",{className:"bg-white border rounded-xl p-4 flex items-center gap-4 shadow-sm",children:[(0,a.jsx)("div",{className:"p-3 bg-blue-50 text-blue-600 rounded-lg",children:(0,a.jsx)(o.A,{size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-slate-500 font-medium",children:"Total Users"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:t.length})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden shadow-sm",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-4 font-semibold text-slate-700",children:"User Details"}),(0,a.jsx)("th",{className:"p-4 font-semibold text-slate-700",children:"Contact Info"}),(0,a.jsx)("th",{className:"p-4 font-semibold text-slate-700",children:"Role"}),(0,a.jsx)("th",{className:"p-4 font-semibold text-slate-700",children:"Join Date"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-slate-100",children:0===t.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"4",className:"p-8 text-center text-slate-500 italic",children:"No users found."})}):t.map(e=>{var t;return(0,a.jsxs)("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center text-blue-600 overflow-hidden border border-blue-100",children:e.profilePicture?(0,a.jsx)("img",{src:e.profilePicture,alt:e.name,className:"w-full h-full object-cover"}):(0,a.jsx)("span",{className:"font-bold text-sm",children:null==(t=e.name)?void 0:t.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-slate-900",children:e.name}),(0,a.jsxs)("div",{className:"text-[10px] text-slate-400 font-mono",children:["ID: ",e._id.slice(-6).toUpperCase()]})]})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,a.jsx)(i.A,{size:14,className:"text-slate-400"}),e.email]}),e.phone&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,a.jsx)(c.A,{size:14,className:"text-slate-400"}),e.phone]})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-bold uppercase tracking-wider\n                                                ".concat("admin"===e.role?"bg-blue-100 text-blue-700":"worker"===e.role?"bg-purple-100 text-purple-700":"bg-emerald-100 text-emerald-700"),children:["admin"===e.role&&(0,a.jsx)(d.A,{size:12}),e.role]})}),(0,a.jsx)("td",{className:"p-4 text-sm text-slate-600",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{size:14,className:"text-slate-400"}),(0,x.Y)(e.createdAt)]})})]},e._id)})})]})})})]})}},13119:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,O:()=>i});var a=s(95155),r=s(12115),l=s(20063),n=s(2676);let o=(0,r.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),i=e=>{let{children:t}=e,[s,i]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0),u=(0,l.useRouter)();(0,r.useEffect)(()=>{let e=(0,n.wz)(),t=(0,n.gf)();e&&t?(console.log("AuthContext: Restoring session. Token present:",!!t),i({...e,token:t})):console.log("AuthContext: No session found in localStorage"),d(!1)},[]);let h=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await s.json();if(!s.ok)throw Error(a.message||"Login failed");return(0,n.E1)(a,a.token),console.log("AuthContext: Login successful. Token:",a.token?"Yes":"No"),i(a),"worker"===a.role?u.push("/worker/dashboard"):"admin"===a.role?u.push("/admin"):u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},m=async(e,t,s,a)=>{try{let r=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,phone:s,password:a})}),l=await r.json();if(!r.ok)throw Error(l.message||"Signup failed");return{success:!0,message:l.message,email:l.email}}catch(e){return{success:!1,message:e.message}}},x=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:t})}),a=await s.json();if(!s.ok)throw Error(a.message||"Verification failed");return(0,n.E1)(a,a.token),console.log("AuthContext: Email verified. Token:",a.token?"Yes":"No"),i(a),u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,a.jsx)(o.Provider,{value:{user:s,setUser:i,loading:c,login:h,register:m,verifyEmail:x,logout:()=>{(0,n.q7)(),i(null),u.push("/login")}},children:t})},c=()=>(0,r.useContext)(o)},16485:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},20063:(e,t,s)=>{"use strict";var a=s(47260);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},23664:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},35299:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},57104:(e,t,s)=>{Promise.resolve().then(s.bind(s,13098))},64269:(e,t,s)=>{"use strict";s.d(t,{Y:()=>n,cn:()=>l});var a=s(2821),r=s(75889);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}function n(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}},69141:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},76907:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},91169:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])}},e=>{e.O(0,[4230,4909,8441,1255,7358],()=>e(e.s=57104)),_N_E=e.O()}]);