(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[240],{2676:(e,t,s)=>{"use strict";s.d(t,{E1:()=>a,gf:()=>n,q7:()=>o,wz:()=>i});let l="auth_session",a=(e,t)=>{let s={user:{_id:e._id,name:e.name,email:e.email,role:e.role||"user",phone:e.phone,isGoogleUser:e.isGoogleUser,profilePicture:e.profilePicture},token:t,expiresAt:Date.now()+2592e6};localStorage.setItem(l,JSON.stringify(s))},r=()=>{try{let e=localStorage.getItem(l);if(!e)return null;let t=JSON.parse(e);if(t.expiresAt&&Date.now()>t.expiresAt)return o(),null;return t}catch(e){return console.error("Error reading session:",e),null}},n=()=>{let e=r();return(null==e?void 0:e.token)||null},i=()=>{let e=r();return(null==e?void 0:e.user)||null},o=()=>{localStorage.removeItem(l),localStorage.removeItem("user"),localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},13119:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,O:()=>o});var l=s(95155),a=s(12115),r=s(20063),n=s(2676);let i=(0,a.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),o=e=>{let{children:t}=e,[s,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),u=(0,r.useRouter)();(0,a.useEffect)(()=>{let e=(0,n.wz)(),t=(0,n.gf)();e&&t?(console.log("AuthContext: Restoring session. Token present:",!!t),o({...e,token:t})):console.log("AuthContext: No session found in localStorage"),d(!1)},[]);let x=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),l=await s.json();if(!s.ok)throw Error(l.message||"Login failed");return(0,n.E1)(l,l.token),console.log("AuthContext: Login successful. Token:",l.token?"Yes":"No"),o(l),"worker"===l.role?u.push("/worker/dashboard"):"admin"===l.role?u.push("/admin"):u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},h=async(e,t,s,l)=>{try{let a=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,phone:s,password:l})}),r=await a.json();if(!a.ok)throw Error(r.message||"Signup failed");return{success:!0,message:r.message,email:r.email}}catch(e){return{success:!1,message:e.message}}},m=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:t})}),l=await s.json();if(!s.ok)throw Error(l.message||"Verification failed");return(0,n.E1)(l,l.token),console.log("AuthContext: Email verified. Token:",l.token?"Yes":"No"),o(l),u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,l.jsx)(i.Provider,{value:{user:s,setUser:o,loading:c,login:x,register:h,verifyEmail:m,logout:()=>{(0,n.q7)(),o(null),u.push("/login")}},children:t})},c=()=>(0,a.useContext)(i)},17085:(e,t,s)=>{Promise.resolve().then(s.bind(s,67743))},35299:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},52056:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},57828:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},67743:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var l=s(95155),a=s(12115),r=s(13119),n=s(24986),i=s(35299),o=s(57828),c=s(71360),d=s(78874),u=s(18720),x=s(52056);function h(e){let{isOpen:t,onClose:s,onConfirm:a,title:r="Are you sure?",message:n="This action cannot be undone.",confirmText:i="Delete",cancelText:o="Cancel",isDestructive:c=!0,isLoading:d=!1}=e;return t?(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,l.jsx)("div",{className:"bg-white rounded-2xl max-w-sm w-full shadow-2xl scale-100 animate-in zoom-in-95 duration-200",onClick:e=>e.stopPropagation(),children:(0,l.jsxs)("div",{className:"p-6 text-center",children:[(0,l.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full flex items-center justify-center mb-4 ".concat(c?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"),children:(0,l.jsx)(x.A,{size:24})}),(0,l.jsx)("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:r}),(0,l.jsx)("p",{className:"text-slate-500 text-sm mb-6",children:n}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("button",{onClick:s,className:"flex-1 px-4 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold rounded-xl transition-colors",disabled:d,children:o}),(0,l.jsx)("button",{onClick:a,className:"flex-1 px-4 py-2.5 text-white font-bold rounded-xl transition-colors shadow-lg flex items-center justify-center gap-2 ".concat(c?"bg-red-500 hover:bg-red-600 shadow-red-200":"bg-blue-500 hover:bg-blue-600 shadow-blue-200"),disabled:d,children:i})]})]})})}):null}function m(){let{user:e,loading:t}=(0,r.A)(),[s,x]=(0,a.useState)([]),[m,p]=(0,a.useState)(!0),[g,f]=(0,a.useState)("All"),[j,y]=(0,a.useState)("All"),[b,N]=(0,a.useState)(null),[v,w]=(0,a.useState)(!1),[k,A]=(0,a.useState)(null),[S,C]=(0,a.useState)(!1),z=async()=>{try{p(!0);let t=null==e?void 0:e.token;if(!t)return;let s="".concat("http://localhost:5000/api","/inquiries?");"All"!==g&&(s+="type=".concat(encodeURIComponent(g),"&")),"All"!==j&&(s+="status=".concat(encodeURIComponent(j)));let l=await fetch(s,{headers:{Authorization:"Bearer ".concat(t)}}),a=await l.json();a.success&&x(a.data)}catch(e){u.o.error("Failed to fetch inquiries")}finally{p(!1)}};(0,a.useEffect)(()=>{!t&&e&&z()},[e,t,g,j]);let E=async(t,s)=>{try{let l=await fetch("".concat("http://localhost:5000/api","/inquiries/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.token)},body:JSON.stringify({status:s})});(await l.json()).success&&(u.o.success("Status updated"),(null==b?void 0:b._id)===t&&N(e=>({...e,status:s})),z())}catch(e){u.o.error("Update failed")}},I=async()=>{if(k){C(!0);try{let t=await fetch("".concat("http://localhost:5000/api","/inquiries/").concat(k),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e.token)}}),s=await t.json();t.ok?(u.o.success("Inquiry deleted successfully"),x(e=>e.filter(e=>e._id!==k)),(null==b?void 0:b._id)===k&&N(null),w(!1),A(null)):u.o.error(s.message||"Failed to delete inquiry")}catch(e){console.error(e),u.o.error("Failed to delete inquiry")}finally{C(!1)}}},P=(e,t)=>{t&&t.stopPropagation(),A(e),w(!0)};return m&&0===s.length?(0,l.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,l.jsx)(i.A,{className:"animate-spin text-blue-500 w-8 h-8"})}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Inquiry Management"}),(0,l.jsx)("p",{className:"text-slate-500 text-sm",children:"Track and manage worker welfare requests"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("select",{value:g,onChange:e=>f(e.target.value),className:"bg-white border border-slate-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"All",children:"All Types"}),(0,l.jsx)("option",{value:"Child Education",children:"Child Education"}),(0,l.jsx)("option",{value:"Worker Registration",children:"Worker Registration"}),(0,l.jsx)("option",{value:"Health Insurance",children:"Health Insurance"}),(0,l.jsx)("option",{value:"Worker Referral",children:"Worker Referral"})]}),(0,l.jsxs)("select",{value:j,onChange:e=>y(e.target.value),className:"bg-white border border-slate-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"All",children:"All Statuses"}),(0,l.jsx)("option",{value:"New",children:"New"}),(0,l.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,l.jsx)("option",{value:"Resolved",children:"Resolved"}),(0,l.jsx)("option",{value:"Rejected",children:"Rejected"})]})]})]}),(0,l.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,l.jsx)("thead",{className:"bg-slate-50 text-slate-500 font-medium",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-4",children:"Status"}),(0,l.jsx)("th",{className:"px-6 py-4",children:"Type"}),(0,l.jsx)("th",{className:"px-6 py-4",children:"From"}),(0,l.jsx)("th",{className:"px-6 py-4",children:"Contact"}),(0,l.jsx)("th",{className:"px-6 py-4",children:"Date"}),(0,l.jsx)("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-100",children:s.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-slate-50 group transition-colors",children:[(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium\n                                            ".concat("New"===e.status?"bg-blue-100 text-blue-800":"Resolved"===e.status?"bg-green-100 text-green-800":"Rejected"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800","\n                                        "),children:e.status})}),(0,l.jsx)("td",{className:"px-6 py-4 font-medium text-slate-900",children:e.type}),(0,l.jsx)("td",{className:"px-6 py-4 text-slate-600",children:e.name}),(0,l.jsx)("td",{className:"px-6 py-4 text-slate-600",children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{children:e.phone}),(0,l.jsx)("span",{className:"text-xs text-slate-400",children:e.email})]})}),(0,l.jsx)("td",{className:"px-6 py-4 text-slate-500",children:(0,n.GP)(new Date(e.createdAt),"MMM d, yyyy")}),(0,l.jsx)("td",{className:"px-6 py-4 text-right",children:(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,l.jsxs)("button",{onClick:()=>N(e),className:"text-blue-600 hover:text-blue-700 font-medium text-sm flex items-center gap-1 hover:bg-blue-50 px-3 py-1.5 rounded-lg transition-colors",children:[(0,l.jsx)(o.A,{size:16})," View"]}),(0,l.jsx)("button",{onClick:t=>P(e._id,t),className:"text-red-500 hover:text-red-600 font-medium text-sm flex items-center gap-1 hover:bg-red-50 px-3 py-1.5 rounded-lg transition-colors",title:"Delete Inquiry",children:(0,l.jsx)(c.A,{size:16})})]})})]},e._id))})]}),0===s.length&&(0,l.jsx)("div",{className:"p-12 text-center text-slate-400",children:"No inquiries found matching your filters."})]})}),b&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>N(null),children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[85vh] overflow-y-auto shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center sticky top-0 bg-white z-10",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-slate-900",children:b.type}),(0,l.jsxs)("p",{className:"text-sm text-slate-500",children:["ID: ",b._id]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:e=>P(b._id,e),className:"p-2 hover:bg-red-50 text-red-500 rounded-full transition-colors",title:"Delete this inquiry",children:(0,l.jsx)(c.A,{size:20})}),(0,l.jsx)("button",{onClick:()=>N(null),className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:(0,l.jsx)(d.A,{className:"text-slate-400",size:24})})]})]}),(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-xs font-semibold uppercase text-slate-400",children:"Applicant Name"}),(0,l.jsx)("p",{className:"text-slate-900 font-medium",children:b.name})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-xs font-semibold uppercase text-slate-400",children:"Submitted On"}),(0,l.jsx)("p",{className:"text-slate-900 font-medium",children:(0,n.GP)(new Date(b.createdAt),"PPpp")})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-xs font-semibold uppercase text-slate-400",children:"Phone"}),(0,l.jsx)("p",{className:"text-slate-900 font-medium",children:b.phone})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-xs font-semibold uppercase text-slate-400",children:"Email"}),(0,l.jsx)("p",{className:"text-slate-900 font-medium",children:b.email||"N/A"})]})]}),(0,l.jsxs)("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-100",children:[(0,l.jsx)("h4",{className:"text-sm font-bold text-slate-700 mb-3",children:"Application Details"}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(b.details||{}).map(e=>{let[t,s]=e;return(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-xs font-medium text-slate-500 capitalize",children:t.replace(/([A-Z])/g," $1").trim()}),(0,l.jsx)("p",{className:"text-slate-800 text-sm",children:(null==s?void 0:s.toString())||"N/A"})]},t)})})]}),(0,l.jsxs)("div",{className:"border-t border-slate-100 pt-6",children:[(0,l.jsx)("label",{className:"text-sm font-semibold text-slate-700 mb-2 block",children:"Update Status"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:["New","In Progress","Resolved","Rejected"].map(e=>(0,l.jsx)("button",{onClick:()=>E(b._id,e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all ".concat(b.status===e?"bg-slate-900 text-white shadow-lg":"bg-white border border-slate-200 text-slate-600 hover:bg-slate-50"),children:e},e))})]})]})]})}),(0,l.jsx)(h,{isOpen:v,onClose:()=>w(!1),onConfirm:I,title:"Delete Inquiry",message:"Are you sure you want to delete this inquiry? This action cannot be undone.",confirmText:"Delete",isDestructive:!0,isLoading:S})]})}},71360:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},78874:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}},e=>{e.O(0,[4230,3461,8441,1255,7358],()=>e(e.s=17085)),_N_E=e.O()}]);