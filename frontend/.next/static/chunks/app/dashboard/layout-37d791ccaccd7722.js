(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1954],{2676:(e,t,r)=>{"use strict";r.d(t,{E1:()=>a,gf:()=>o,q7:()=>i,wz:()=>n});let s="auth_session",a=(e,t)=>{let r={user:{_id:e._id,name:e.name,email:e.email,role:e.role||"user",phone:e.phone,isGoogleUser:e.isGoogleUser,profilePicture:e.profilePicture},token:t,expiresAt:Date.now()+2592e6};localStorage.setItem(s,JSON.stringify(r))},l=()=>{try{let e=localStorage.getItem(s);if(!e)return null;let t=JSON.parse(e);if(t.expiresAt&&Date.now()>t.expiresAt)return i(),null;return t}catch(e){return console.error("Error reading session:",e),null}},o=()=>{let e=l();return(null==e?void 0:e.token)||null},n=()=>{let e=l();return(null==e?void 0:e.user)||null},i=()=>{localStorage.removeItem(s),localStorage.removeItem("user"),localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},9540:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]])},13119:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,O:()=>i});var s=r(95155),a=r(12115),l=r(20063),o=r(2676);let n=(0,a.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),i=e=>{let{children:t}=e,[r,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),h=(0,l.useRouter)();(0,a.useEffect)(()=>{let e=(0,o.wz)(),t=(0,o.gf)();e&&t?(console.log("AuthContext: Restoring session. Token present:",!!t),i({...e,token:t})):console.log("AuthContext: No session found in localStorage"),d(!1)},[]);let u=async(e,t)=>{try{let r=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),s=await r.json();if(!r.ok)throw Error(s.message||"Login failed");return(0,o.E1)(s,s.token),console.log("AuthContext: Login successful. Token:",s.token?"Yes":"No"),i(s),"worker"===s.role?h.push("/worker/dashboard"):"admin"===s.role?h.push("/admin"):h.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},m=async(e,t,r,s)=>{try{let a=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,phone:r,password:s})}),l=await a.json();if(!a.ok)throw Error(l.message||"Signup failed");return{success:!0,message:l.message,email:l.email}}catch(e){return{success:!1,message:e.message}}},f=async(e,t)=>{try{let r=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:t})}),s=await r.json();if(!r.ok)throw Error(s.message||"Verification failed");return(0,o.E1)(s,s.token),console.log("AuthContext: Email verified. Token:",s.token?"Yes":"No"),i(s),h.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,s.jsx)(n.Provider,{value:{user:r,setUser:i,loading:c,login:u,register:m,verifyEmail:f,logout:()=>{(0,o.q7)(),i(null),h.push("/login")}},children:t})},c=()=>(0,a.useContext)(n)},20063:(e,t,r)=>{"use strict";var s=r(47260);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},20508:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},59384:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},65229:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},65993:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},71847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(12115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:h,...u}=e;return(0,s.createElement)("svg",{ref:t,...o,width:a,height:a,stroke:r,strokeWidth:i?24*Number(n)/Number(a):n,className:l("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(u)&&{"aria-hidden":"true"},...u},[...h.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let r=(0,s.forwardRef)((r,o)=>{let{className:i,...c}=r;return(0,s.createElement)(n,{ref:o,iconNode:t,className:l("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...c})});return r.displayName=a(e),r}},84200:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(95155),a=r(13119),l=r(20063),o=r(12115),n=r(52619),i=r.n(n),c=r(59384),d=r(71847);let h=(0,d.A)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),u=(0,d.A)("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);var m=r(20508),f=r(65229),p=r(65993),x=r(84926),g=r(9540);function y(e){var t;let{children:r}=e,{user:n,loading:d,logout:y}=(0,a.A)(),k=(0,l.useRouter)(),b=(0,l.usePathname)(),[v,w]=(0,o.useState)(!1);if((0,o.useEffect)(()=>{d||n||k.push("/login")},[n,d,k]),(0,o.useEffect)(()=>{w(!1)},[b]),!n)return null;let j=[{name:"Overview",href:"/dashboard",icon:c.A},{name:"My Bookings",href:"/dashboard/bookings",icon:h},{name:"Attendance",href:"/dashboard/attendance",icon:u},{name:"Profile",href:"/dashboard/profile",icon:m.A}];return null==n||n.role,(0,s.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[v&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>w(!1)}),(0,s.jsxs)("aside",{className:"fixed inset-y-0 left-0 z-50 w-72 bg-white transform transition-transform duration-300 ease-in-out md:hidden ".concat(v?"translate-x-0":"-translate-x-full"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100",children:[(0,s.jsx)(i(),{href:"/dashboard",className:"text-xl font-bold font-display",children:(0,s.jsx)("span",{className:"text-primary-600",children:"Safely Hands"})}),(0,s.jsx)("button",{onClick:()=>w(!1),className:"p-2 hover:bg-slate-100 rounded-lg",children:(0,s.jsx)(f.A,{size:20})})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2 p-4",children:j.map(e=>{let t=e.icon,r=b===e.href;return(0,s.jsxs)(i(),{href:e.href,className:"flex items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium transition-colors ".concat(r?"bg-primary-50 text-primary-600":"text-gray-500 hover:bg-gray-100 hover:text-gray-900"),children:[(0,s.jsx)(t,{className:"h-5 w-5"}),e.name]},e.href)})}),(0,s.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t space-y-2",children:[(0,s.jsxs)(i(),{href:"/",className:"flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-900",children:[(0,s.jsx)(p.A,{className:"h-5 w-5"}),"Back to Site"]}),(0,s.jsxs)("button",{onClick:()=>{y(),k.push("/")},className:"flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium text-red-500 hover:bg-red-50",children:[(0,s.jsx)(x.A,{className:"h-5 w-5"}),"Sign Out"]})]})]}),(0,s.jsxs)("aside",{className:"hidden w-64 border-r bg-white md:block shrink-0",children:[(0,s.jsx)("div",{className:"p-6 border-b border-slate-100",children:(0,s.jsx)(i(),{href:"/dashboard",className:"text-2xl font-bold font-display text-slate-900",children:(0,s.jsx)("span",{className:"text-primary-600",children:"Safely Hands"})})}),(0,s.jsx)("div",{className:"flex flex-col gap-2 p-4",children:j.map(e=>{let t=e.icon,r=b===e.href;return(0,s.jsxs)(i(),{href:e.href,className:"flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors ".concat(r?"bg-primary-50 text-primary-600":"text-gray-500 hover:bg-gray-100 hover:text-gray-900"),children:[(0,s.jsx)(t,{className:"h-4 w-4"}),e.name]},e.href)})}),(0,s.jsxs)("div",{className:"mt-auto p-4 border-t space-y-2",children:[(0,s.jsxs)(i(),{href:"/",className:"flex w-full items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-900",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),"Back to Site"]}),(0,s.jsxs)("button",{onClick:()=>{y(),k.push("/")},className:"flex w-full items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium text-red-500 hover:bg-red-50",children:[(0,s.jsx)(x.A,{className:"h-4 w-4"}),"Sign Out"]})]})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,s.jsxs)("header",{className:"h-14 bg-white border-b flex items-center justify-between px-4 md:hidden",children:[(0,s.jsx)("button",{onClick:()=>w(!0),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,s.jsx)(g.A,{size:24})}),(0,s.jsx)("span",{className:"font-semibold text-gray-800",children:"Dashboard"}),(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-100 flex items-center justify-center text-primary-600 font-bold text-sm overflow-hidden",children:n.profilePicture?(0,s.jsx)("img",{src:n.profilePicture,alt:n.name,className:"w-full h-full object-cover"}):null==n||null==(t=n.name)?void 0:t.charAt(0).toUpperCase()})]}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,s.jsx)("div",{className:"p-4 md:p-8",children:r})})]})]})}},84926:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},86986:(e,t,r)=>{Promise.resolve().then(r.bind(r,84200))}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=86986)),_N_E=e.O()}]);