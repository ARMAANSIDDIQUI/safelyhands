(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5620],{2676:(e,t,s)=>{"use strict";s.d(t,{E1:()=>o,gf:()=>l,q7:()=>i,wz:()=>n});let a="auth_session",o=(e,t)=>{let s={user:{_id:e._id,name:e.name,email:e.email,role:e.role||"user",phone:e.phone,isGoogleUser:e.isGoogleUser,profilePicture:e.profilePicture},token:t,expiresAt:Date.now()+2592e6};localStorage.setItem(a,JSON.stringify(s))},r=()=>{try{let e=localStorage.getItem(a);if(!e)return null;let t=JSON.parse(e);if(t.expiresAt&&Date.now()>t.expiresAt)return i(),null;return t}catch(e){return console.error("Error reading session:",e),null}},l=()=>{let e=r();return(null==e?void 0:e.token)||null},n=()=>{let e=r();return(null==e?void 0:e.user)||null},i=()=>{localStorage.removeItem(a),localStorage.removeItem("user"),localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},6191:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},13119:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,O:()=>i});var a=s(95155),o=s(12115),r=s(20063),l=s(2676);let n=(0,o.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),i=e=>{let{children:t}=e,[s,i]=(0,o.useState)(null),[c,d]=(0,o.useState)(!0),u=(0,r.useRouter)();(0,o.useEffect)(()=>{let e=(0,l.wz)(),t=(0,l.gf)();e&&t?(console.log("AuthContext: Restoring session. Token present:",!!t),i({...e,token:t})):console.log("AuthContext: No session found in localStorage"),d(!1)},[]);let h=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await s.json();if(!s.ok)throw Error(a.message||"Login failed");return(0,l.E1)(a,a.token),console.log("AuthContext: Login successful. Token:",a.token?"Yes":"No"),i(a),"worker"===a.role?u.push("/worker/dashboard"):"admin"===a.role?u.push("/admin"):u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},m=async(e,t,s,a)=>{try{let o=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,phone:s,password:a})}),r=await o.json();if(!o.ok)throw Error(r.message||"Signup failed");return{success:!0,message:r.message,email:r.email}}catch(e){return{success:!1,message:e.message}}},g=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:t})}),a=await s.json();if(!s.ok)throw Error(a.message||"Verification failed");return(0,l.E1)(a,a.token),console.log("AuthContext: Email verified. Token:",a.token?"Yes":"No"),i(a),u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,a.jsx)(n.Provider,{value:{user:s,setUser:i,loading:c,login:h,register:m,verifyEmail:g,logout:()=>{(0,l.q7)(),i(null),u.push("/login")}},children:t})},c=()=>(0,o.useContext)(n)},20063:(e,t,s)=>{"use strict";var a=s(47260);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},21190:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},44743:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(95155),o=s(12115),r=s(6191),l=s(21190),n=s(71360),i=s(18720),c=s(13119);function d(){let{user:e}=(0,c.A)(),[t,s]=(0,o.useState)([]),[d,u]=(0,o.useState)(!0),[h,m]=(0,o.useState)(!1),[g,p]=(0,o.useState)(null),[x,f]=(0,o.useState)({name:"",slug:""});(0,o.useEffect)(()=>{y()},[]);let y=async()=>{try{let e=await fetch("".concat("http://localhost:5000/api","/team-categories"));e.ok&&s(await e.json())}catch(e){i.o.error("Failed to fetch categories")}finally{u(!1)}},b=async e=>{e.preventDefault();let t=g?"".concat("http://localhost:5000/api","/team-categories/").concat(g._id):"".concat("http://localhost:5000/api","/team-categories"),s=g?"PUT":"POST";try{(await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(x)})).ok&&(i.o.success(g?"Category updated":"Category added"),m(!1),p(null),f({name:"",slug:""}),y())}catch(e){i.o.error("Operation failed")}},j=async e=>{if(confirm("Are you sure? This might affect team members in this category."))try{(await fetch("".concat("http://localhost:5000/api","/team-categories/").concat(e),{method:"DELETE"})).ok&&(i.o.success("Category removed"),y())}catch(e){i.o.error("Delete failed")}};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Team Categories"}),(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"Organize your team members into roles/categories"})]}),(0,a.jsxs)("button",{onClick:()=>{p(null),f({name:"",slug:""}),m(!0)},className:"bg-indigo-500 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-indigo-600 transition-colors shadow-lg shadow-indigo-100",children:[(0,a.jsx)(r.A,{size:18})," Add Category"]})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden max-w-2xl",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{className:"bg-slate-50 text-slate-500 text-xs uppercase font-bold",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4",children:"Category Name"}),(0,a.jsx)("th",{className:"px-6 py-4",children:"Slug"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-slate-100",children:d?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"3",className:"px-6 py-10 text-center text-slate-400",children:"Loading..."})}):0===t.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"3",className:"px-6 py-10 text-center text-slate-400",children:"No categories found."})}):t.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"font-bold text-slate-800",children:e.name})}),(0,a.jsxs)("td",{className:"px-6 py-4 text-slate-500 font-medium",children:["/",e.slug||e.name.toLowerCase().replace(/\s+/g,"-")]}),(0,a.jsx)("td",{className:"px-6 py-4 text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)("button",{onClick:()=>{p(e),f({name:e.name,slug:e.slug||e.name.toLowerCase().replace(/\s+/g,"-")}),m(!0)},className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",children:(0,a.jsx)(l.A,{size:18})}),(0,a.jsx)("button",{onClick:()=>j(e._id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:(0,a.jsx)(n.A,{size:18})})]})})]},e._id))})]})})}),h&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-slate-100",children:(0,a.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:g?"Edit Category":"Add New Category"})}),(0,a.jsxs)("form",{onSubmit:b,className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Category Name"}),(0,a.jsx)("input",{required:!0,type:"text",value:x.name,onChange:e=>{let t=e.target.value;f({...x,name:t,slug:t.toLowerCase().replace(/\s+/g,"-")})},className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:outline-none focus:border-indigo-500",placeholder:"e.g. Leadership"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"URL Slug"}),(0,a.jsx)("input",{required:!0,type:"text",value:x.slug,onChange:e=>f({...x,slug:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:outline-none focus:border-indigo-500",placeholder:"e.g. leadership"})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 font-bold",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 shadow-lg shadow-indigo-100 font-bold",children:g?"Save Changes":"Add Category"})]})]})]})})]})}},69747:(e,t,s)=>{Promise.resolve().then(s.bind(s,44743))},71360:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}},e=>{e.O(0,[4230,8441,1255,7358],()=>e(e.s=69747)),_N_E=e.O()}]);