(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[892],{2676:(e,t,s)=>{"use strict";s.d(t,{E1:()=>l,gf:()=>o,q7:()=>i,wz:()=>n});let a="auth_session",l=(e,t)=>{let s={user:{_id:e._id,name:e.name,email:e.email,role:e.role||"user",phone:e.phone,isGoogleUser:e.isGoogleUser,profilePicture:e.profilePicture},token:t,expiresAt:Date.now()+2592e6};localStorage.setItem(a,JSON.stringify(s))},r=()=>{try{let e=localStorage.getItem(a);if(!e)return null;let t=JSON.parse(e);if(t.expiresAt&&Date.now()>t.expiresAt)return i(),null;return t}catch(e){return console.error("Error reading session:",e),null}},o=()=>{let e=r();return(null==e?void 0:e.token)||null},n=()=>{let e=r();return(null==e?void 0:e.user)||null},i=()=>{localStorage.removeItem(a),localStorage.removeItem("user"),localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},13119:(e,t,s)=>{"use strict";s.d(t,{A:()=>d,O:()=>i});var a=s(95155),l=s(12115),r=s(20063),o=s(2676);let n=(0,l.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),i=e=>{let{children:t}=e,[s,i]=(0,l.useState)(null),[d,c]=(0,l.useState)(!0),u=(0,r.useRouter)();(0,l.useEffect)(()=>{let e=(0,o.wz)(),t=(0,o.gf)();e&&t?(console.log("AuthContext: Restoring session. Token present:",!!t),i({...e,token:t})):console.log("AuthContext: No session found in localStorage"),c(!1)},[]);let p=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await s.json();if(!s.ok)throw Error(a.message||"Login failed");return(0,o.E1)(a,a.token),console.log("AuthContext: Login successful. Token:",a.token?"Yes":"No"),i(a),"worker"===a.role?u.push("/worker/dashboard"):"admin"===a.role?u.push("/admin"):u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},h=async(e,t,s,a)=>{try{let l=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,phone:s,password:a})}),r=await l.json();if(!l.ok)throw Error(r.message||"Signup failed");return{success:!0,message:r.message,email:r.email}}catch(e){return{success:!1,message:e.message}}},x=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:t})}),a=await s.json();if(!s.ok)throw Error(a.message||"Verification failed");return(0,o.E1)(a,a.token),console.log("AuthContext: Email verified. Token:",a.token?"Yes":"No"),i(a),u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,a.jsx)(n.Provider,{value:{user:s,setUser:i,loading:d,login:p,register:h,verifyEmail:x,logout:()=>{(0,o.q7)(),i(null),u.push("/login")}},children:t})},d=()=>(0,l.useContext)(n)},20063:(e,t,s)=>{"use strict";var a=s(47260);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},33263:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(95155),l=s(12115),r=s(35626),o=s(71360),n=s(20063),i=s(18720),d=s(13119);function c(){let{id:e}=(0,n.useParams)(),t=(0,n.useRouter)(),{user:s}=(0,d.A)(),[c,u]=(0,l.useState)(!1),[p,h]=(0,l.useState)({name:"",price:"",description:"",imageUrl:"",features:[""],isActive:!0,questions:[]}),x=(e,t,s)=>{let a=[...p.questions];a[e].fields[t]=s,h({...p,questions:a})},m=async a=>{a.preventDefault(),u(!0);try{let a={...p,price:parseFloat(p.price),service:e};(await fetch("".concat("http://localhost:5000/api","/services/").concat(e,"/subcategories"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s.token)},body:JSON.stringify(a)})).ok?(i.o.success("SubCategory created"),t.push("/dashboard/admin/services/".concat(e))):i.o.error("Failed to create")}catch(e){i.o.error("Error submitting form")}finally{u(!1)}};return(0,a.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsx)("button",{onClick:()=>t.back(),className:"p-2 hover:bg-slate-100 rounded-full",children:(0,a.jsx)(r.A,{size:24})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"New SubCategory"})]}),(0,a.jsxs)("form",{onSubmit:m,className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6 shadow-sm",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800 mb-4",children:"Basic Info"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Name"}),(0,a.jsx)("input",{required:!0,type:"text",value:p.name,onChange:e=>h({...p,name:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg",placeholder:"e.g. Morning Shift"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Base Price (â‚¹)"}),(0,a.jsx)("input",{required:!0,type:"number",value:p.price,onChange:e=>h({...p,price:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Image URL"}),(0,a.jsx)("input",{type:"text",value:p.imageUrl,onChange:e=>h({...p,imageUrl:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg",placeholder:"https://..."})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Description"}),(0,a.jsx)("textarea",{value:p.description,onChange:e=>h({...p,description:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg h-20"})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Features"}),(0,a.jsxs)("div",{className:"space-y-2",children:[p.features.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>((e,t)=>{let s=[...p.features];s[e]=t,h({...p,features:s})})(t,e.target.value),className:"flex-1 px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg"}),(0,a.jsx)("button",{type:"button",onClick:()=>(e=>{let t=p.features.filter((t,s)=>s!==e);h({...p,features:t})})(t),className:"text-red-500 hover:bg-red-50 p-2 rounded-lg",children:(0,a.jsx)(o.A,{size:18})})]},t)),(0,a.jsx)("button",{type:"button",onClick:()=>h({...p,features:[...p.features,""]}),className:"text-sm font-bold text-blue-500 hover:text-blue-600",children:"+ Add Feature"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Question Steps"}),(0,a.jsx)("button",{type:"button",onClick:()=>{h({...p,questions:[...p.questions,{stepTitle:"Details",fields:[]}]})},className:"bg-slate-800 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-slate-900",children:"+ Add Step"})]}),p.questions.map((e,t)=>(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6 shadow-sm relative",children:[(0,a.jsx)("button",{type:"button",onClick:()=>(e=>{let t=p.questions.filter((t,s)=>s!==e);h({...p,questions:t})})(t),className:"absolute top-4 right-4 text-red-500 hover:bg-red-50 p-2 rounded-lg",children:(0,a.jsx)(o.A,{size:18})}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-1",children:"Step Title"}),(0,a.jsx)("input",{type:"text",value:e.stepTitle,onChange:e=>((e,t)=>{let s=[...p.questions];s[e].stepTitle=t,h({...p,questions:s})})(t,e.target.value),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg font-bold"})]}),(0,a.jsxs)("div",{className:"space-y-4 pl-4 border-l-2 border-slate-100",children:[e.fields.map((e,s)=>(0,a.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-slate-500",children:"Label (Question)"}),(0,a.jsx)("input",{type:"text",value:e.label,onChange:a=>{x(t,s,{...e,label:a.target.value})},className:"w-full mt-1 px-3 py-2 bg-white border border-slate-200 rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-slate-500",children:"Key Name (Unique)"}),(0,a.jsx)("input",{type:"text",value:e.name,onChange:a=>{x(t,s,{...e,name:a.target.value})},className:"w-full mt-1 px-3 py-2 bg-white border border-slate-200 rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-slate-500",children:"Type"}),(0,a.jsxs)("select",{value:e.type,onChange:a=>{x(t,s,{...e,type:a.target.value})},className:"w-full mt-1 px-3 py-2 bg-white border border-slate-200 rounded",children:[(0,a.jsx)("option",{value:"radio",children:"Radio Buttons"}),(0,a.jsx)("option",{value:"select",children:"Dropdown"}),(0,a.jsx)("option",{value:"checkbox",children:"Checkbox"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-xs font-bold text-slate-500",children:"Options"}),e.options.map((l,r)=>(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("input",{placeholder:"Label",value:l.label,onChange:a=>{let l=[...e.options];l[r].label=a.target.value,x(t,s,{...e,options:l})},className:"flex-1 px-3 py-1 bg-white border border-slate-200 rounded text-sm"}),(0,a.jsx)("input",{placeholder:"Value",value:l.value,onChange:a=>{let l=[...e.options];l[r].value=a.target.value,x(t,s,{...e,options:l})},className:"flex-1 px-3 py-1 bg-white border border-slate-200 rounded text-sm"}),(0,a.jsx)("input",{type:"number",placeholder:"Price (+)",value:l.priceChange,onChange:a=>{let l=[...e.options];l[r].priceChange=parseFloat(a.target.value)||0,x(t,s,{...e,options:l})},className:"w-24 px-3 py-1 bg-white border border-slate-200 rounded text-sm"}),(0,a.jsx)("button",{type:"button",onClick:()=>{let a=e.options.filter((e,t)=>t!==r);x(t,s,{...e,options:a})},className:"text-red-400 hover:text-red-500",children:(0,a.jsx)(o.A,{size:16})})]},r)),(0,a.jsx)("button",{type:"button",onClick:()=>{let a=[...e.options,{label:"",value:"",priceChange:0}];x(t,s,{...e,options:a})},className:"text-xs font-bold text-blue-500 hover:text-blue-600",children:"+ Add Option"})]}),(0,a.jsx)("div",{className:"mt-2 text-right",children:(0,a.jsx)("button",{type:"button",onClick:()=>((e,t)=>{let s=[...p.questions];s[e].fields=s[e].fields.filter((e,s)=>s!==t),h({...p,questions:s})})(t,s),className:"text-xs text-red-500 hover:underline",children:"Remove Field"})})]},s)),(0,a.jsx)("button",{type:"button",onClick:()=>(e=>{let t=[...p.questions];t[e].fields.push({name:"",label:"",type:"radio",options:[{label:"",value:"",priceChange:0}],required:!0}),h({...p,questions:t})})(t),className:"w-full py-2 border-2 border-dashed border-slate-200 rounded-lg text-slate-400 font-bold hover:border-slate-300 hover:text-slate-500",children:"+ Add Field"})]})]},t))]}),(0,a.jsxs)("div",{className:"sticky bottom-4 bg-white p-4 rounded-xl border border-slate-200 shadow-xl flex justify-between items-center",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Review details before saving."}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"bg-orange-500 text-white px-8 py-3 rounded-xl font-bold hover:bg-orange-600 disabled:opacity-50",children:c?"Saving...":"Create SubCategory"})]})]})]})}},35626:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},36323:(e,t,s)=>{Promise.resolve().then(s.bind(s,33263))},71360:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}},e=>{e.O(0,[4230,8441,1255,7358],()=>e(e.s=36323)),_N_E=e.O()}]);