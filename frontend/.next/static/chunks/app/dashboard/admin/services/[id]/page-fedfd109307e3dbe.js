(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9288],{6191:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},11010:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},13119:(e,s,t)=>{"use strict";t.d(s,{A:()=>n,O:()=>i});var a=t(95155),l=t(12115),r=t(20063),o=t(2676);let c=(0,l.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),i=e=>{let{children:s}=e,[t,i]=(0,l.useState)(null),[n,d]=(0,l.useState)(!0),u=(0,r.useRouter)();(0,l.useEffect)(()=>{let e=(0,o.wz)(),s=(0,o.gf)();e&&s?(console.log("AuthContext: Restoring session. Token present:",!!s),i({...e,token:s})):console.log("AuthContext: No session found in localStorage"),d(!1)},[]);let h=async(e,s)=>{try{let t=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:s})}),a=await t.json();if(!t.ok)throw Error(a.message||"Login failed");return(0,o.E1)(a,a.token),console.log("AuthContext: Login successful. Token:",a.token?"Yes":"No"),i(a),"worker"===a.role?u.push("/worker/dashboard"):"admin"===a.role?u.push("/admin"):u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},m=async(e,s,t,a)=>{try{let l=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:s,phone:t,password:a})}),r=await l.json();if(!l.ok)throw Error(r.message||"Signup failed");return{success:!0,message:r.message,email:r.email}}catch(e){return{success:!1,message:e.message}}},x=async(e,s)=>{try{let t=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:s})}),a=await t.json();if(!t.ok)throw Error(a.message||"Verification failed");return(0,o.E1)(a,a.token),console.log("AuthContext: Email verified. Token:",a.token?"Yes":"No"),i(a),u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,a.jsx)(c.Provider,{value:{user:t,setUser:i,loading:n,login:h,register:m,verifyEmail:x,logout:()=>{(0,o.q7)(),i(null),u.push("/login")}},children:s})},n=()=>(0,l.useContext)(c)},20063:(e,s,t)=>{"use strict";var a=t(47260);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},21075:(e,s,t)=>{Promise.resolve().then(t.bind(t,85467))},65229:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},85467:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var a=t(95155),l=t(12115),r=t(35626),o=t(46046),c=t(6191),i=t(11010),n=t(52619),d=t.n(n),u=t(20063),h=t(18720),m=t(13119),x=t(9880);function g(){let{id:e}=(0,u.useParams)(),s=(0,u.useRouter)(),{user:t}=(0,m.A)(),[n,g]=(0,l.useState)(!0),[p,b]=(0,l.useState)([]),[v,f]=(0,l.useState)({title:"",slug:"",description:"",imageUrl:"",icon:"",isActive:!0,selectionMode:"single",gender:"Both"});(0,l.useEffect)(()=>{e&&(j(),y())},[e]);let j=async()=>{try{let s=await fetch("".concat("http://localhost:5000/api","/services/").concat(e));if(s.ok){let e=await s.json();f({title:e.title,slug:e.slug,description:e.description,imageUrl:e.imageUrl||"",icon:e.icon||"",isActive:e.isActive,selectionMode:e.selectionMode||"single",gender:e.gender||"Both"})}}catch(e){h.o.error("Failed to fetch service")}finally{g(!1)}},y=async()=>{try{let s=await fetch("".concat("http://localhost:5000/api","/services/").concat(e,"/subcategories"));s.ok&&b(await s.json())}catch(e){console.error("Failed to fetch subcategories")}},N=async s=>{s.preventDefault();try{(await fetch("".concat("http://localhost:5000/api","/services/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)},body:JSON.stringify(v)})).ok?h.o.success("Service updated"):h.o.error("Failed to update")}catch(e){h.o.error("Error updating service")}};return(0,a.jsxs)("div",{className:"p-6 max-w-5xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsx)("button",{onClick:()=>s.back(),className:"p-2 hover:bg-slate-100 rounded-full",children:(0,a.jsx)(r.A,{size:24})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Edit Service"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6 shadow-sm",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800 mb-4",children:"Basic Details"}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Title"}),(0,a.jsx)("input",{type:"text",value:v.title,onChange:e=>f({...v,title:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Slug"}),(0,a.jsx)("input",{type:"text",value:v.slug,disabled:!0,className:"w-full px-4 py-2 bg-slate-100 border border-slate-200 rounded-lg text-slate-500 cursor-not-allowed"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Description"}),(0,a.jsx)("textarea",{value:v.description,onChange:e=>f({...v,description:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg h-32"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Icon (Lucide name)"}),(0,a.jsx)("input",{type:"text",value:v.icon,onChange:e=>f({...v,icon:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg",placeholder:"e.g. Home, User"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Service Image"}),(0,a.jsx)(x.A,{value:v.imageUrl,onChange:e=>f({...v,imageUrl:e})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Selection Mode"}),(0,a.jsxs)("select",{value:v.selectionMode,onChange:e=>f({...v,selectionMode:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg",children:[(0,a.jsx)("option",{value:"single",children:"Single (Replace)"}),(0,a.jsx)("option",{value:"multiple",children:"Multiple (Accumulate)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Gender"}),(0,a.jsxs)("select",{value:v.gender,onChange:e=>f({...v,gender:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg",children:[(0,a.jsx)("option",{value:"Both",children:"Both"}),(0,a.jsx)("option",{value:"Male",children:"Male"}),(0,a.jsx)("option",{value:"Female",children:"Female"})]})]})]}),(0,a.jsx)("div",{className:"pt-4",children:(0,a.jsxs)("button",{type:"submit",className:"bg-blue-500 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-600 flex items-center gap-2",children:[(0,a.jsx)(o.A,{size:18})," Save Changes"]})})]})]})}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Sub-Categories"}),(0,a.jsx)(d(),{href:"/dashboard/admin/services/".concat(e,"/subcategories/new"),className:"text-blue-500 hover:bg-blue-50 p-2 rounded-lg",children:(0,a.jsx)(c.A,{size:20})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[p.map(s=>(0,a.jsx)("div",{className:"p-3 border border-slate-100 rounded-lg hover:bg-slate-50 transition-all group",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-slate-900 text-sm",children:s.name}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["â‚¹",s.price]})]}),(0,a.jsx)(d(),{href:"/dashboard/admin/services/".concat(e,"/subcategories/").concat(s._id),className:"text-slate-400 hover:text-blue-600",children:(0,a.jsx)(i.A,{size:16})})]})},s._id)),0===p.length&&(0,a.jsx)("p",{className:"text-sm text-slate-400 text-center py-4",children:"No sub-categories yet."})]})]})})]})]})}}},e=>{e.O(0,[4230,2619,4909,6184,8441,1255,7358],()=>e(e.s=21075)),_N_E=e.O()}]);