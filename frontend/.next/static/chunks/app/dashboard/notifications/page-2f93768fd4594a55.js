(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1654],{2676:(e,t,r)=>{"use strict";r.d(t,{E1:()=>a,gf:()=>s,q7:()=>i,wz:()=>l});let n="auth_session",a=(e,t)=>{let r={user:{_id:e._id,name:e.name,email:e.email,role:e.role||"user",phone:e.phone,isGoogleUser:e.isGoogleUser,profilePicture:e.profilePicture},token:t,expiresAt:Date.now()+2592e6};localStorage.setItem(n,JSON.stringify(r))},o=()=>{try{let e=localStorage.getItem(n);if(!e)return null;let t=JSON.parse(e);if(t.expiresAt&&Date.now()>t.expiresAt)return i(),null;return t}catch(e){return console.error("Error reading session:",e),null}},s=()=>{let e=o();return(null==e?void 0:e.token)||null},l=()=>{let e=o();return(null==e?void 0:e.user)||null},i=()=>{localStorage.removeItem(n),localStorage.removeItem("user"),localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},13119:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,O:()=>i});var n=r(95155),a=r(12115),o=r(20063),s=r(2676);let l=(0,a.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),i=e=>{let{children:t}=e,[r,i]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0),d=(0,o.useRouter)();(0,a.useEffect)(()=>{let e=(0,s.wz)(),t=(0,s.gf)();e&&t?(console.log("AuthContext: Restoring session. Token present:",!!t),i({...e,token:t})):console.log("AuthContext: No session found in localStorage"),u(!1)},[]);let f=async(e,t)=>{try{let r=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),n=await r.json();if(!r.ok)throw Error(n.message||"Login failed");return(0,s.E1)(n,n.token),console.log("AuthContext: Login successful. Token:",n.token?"Yes":"No"),i(n),"worker"===n.role?d.push("/worker/dashboard"):"admin"===n.role?d.push("/admin"):d.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},m=async(e,t,r,n)=>{try{let a=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,phone:r,password:n})}),o=await a.json();if(!a.ok)throw Error(o.message||"Signup failed");return{success:!0,message:o.message,email:o.email}}catch(e){return{success:!1,message:e.message}}},h=async(e,t)=>{try{let r=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:t})}),n=await r.json();if(!r.ok)throw Error(n.message||"Verification failed");return(0,s.E1)(n,n.token),console.log("AuthContext: Email verified. Token:",n.token?"Yes":"No"),i(n),d.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,n.jsx)(l.Provider,{value:{user:r,setUser:i,loading:c,login:f,register:m,verifyEmail:h,logout:()=>{(0,s.q7)(),i(null),d.push("/login")}},children:t})},c=()=>(0,a.useContext)(l)},20063:(e,t,r)=>{"use strict";var n=r(47260);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},32467:(e,t,r)=>{"use strict";r.d(t,{DX:()=>d,TL:()=>u});var n,a=r(12115),o=r(94446),s=r(95155),l=Symbol.for("react.lazy"),i=(n||(n=r.t(a,2)))[" use ".trim().toString()];function c(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===l&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}function u(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:r,...n}=e;if(c(r)&&"function"==typeof i&&(r=i(r._payload)),a.isValidElement(r)){var s;let e,l,i=(s=r,(l=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.ref:(l=(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.props.ref:s.props.ref||s.ref),c=function(e,t){let r={...t};for(let n in t){let a=e[n],o=t[n];/^on[A-Z]/.test(n)?a&&o?r[n]=(...e)=>{let t=o(...e);return a(...e),t}:a&&(r[n]=a):"style"===n?r[n]={...a,...o}:"className"===n&&(r[n]=[a,o].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==a.Fragment&&(c.ref=t?(0,o.t)(t,i):i),a.cloneElement(r,c)}return a.Children.count(r)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=a.forwardRef((e,r)=>{let{children:n,...o}=e;c(n)&&"function"==typeof i&&(n=i(n._payload));let l=a.Children.toArray(n),u=l.find(m);if(u){let e=u.props.children,n=l.map(t=>t!==u?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,s.jsx)(t,{...o,ref:r,children:a.isValidElement(e)?a.cloneElement(e,void 0,n):null})}return(0,s.jsx)(t,{...o,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}var d=u("Slot"),f=Symbol("radix.slottable");function m(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===f}},35299:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},52869:(e,t,r)=>{Promise.resolve().then(r.bind(r,93883))},57356:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var n=r(95155),a=r(12115),o=r(32467),s=r(83101),l=r(64269);let i=(0,s.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:s,asChild:c=!1,...u}=e,d=c?o.DX:"button";return(0,n.jsx)(d,{className:(0,l.cn)(i({variant:a,size:s,className:r})),ref:t,...u})});c.displayName="Button"},64269:(e,t,r)=>{"use strict";r.d(t,{Y:()=>s,cn:()=>o});var n=r(2821),a=r(75889);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,n.$)(t))}function s(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}},71847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(12115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:u,iconNode:d,...f}=e;return(0,n.createElement)("svg",{ref:t,...s,width:a,height:a,stroke:r,strokeWidth:i?24*Number(l)/Number(a):l,className:o("lucide",c),...!u&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(f)&&{"aria-hidden":"true"},...f},[...d.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),i=(e,t)=>{let r=(0,n.forwardRef)((r,s)=>{let{className:i,...c}=r;return(0,n.createElement)(l,{ref:s,iconNode:t,className:o("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...c})});return r.displayName=a(e),r}},83101:(e,t,r)=>{"use strict";r.d(t,{F:()=>s});var n=r(2821);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,o=n.$,s=(e,t)=>r=>{var n;if((null==t?void 0:t.variants)==null)return o(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:s,defaultVariants:l}=t,i=Object.keys(s).map(e=>{let t=null==r?void 0:r[e],n=null==l?void 0:l[e];if(null===t)return null;let o=a(t)||a(n);return s[e][o]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return o(e,i,null==t||null==(n=t.compoundVariants)?void 0:n.reduce((e,t)=>{let{class:r,className:n,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...c}[t]):({...l,...c})[t]===r})?[...e,r,n]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}},90758:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>u,ZB:()=>i,Zp:()=>s,aR:()=>l,wL:()=>d});var n=r(95155),a=r(12115),o=r(64269);let s=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...a})});s.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,o.cn)("font-semibold leading-none tracking-tight",r),...a})});i.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...a})});u.displayName="CardContent";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...a})});d.displayName="CardFooter"},93883:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var n=r(95155),a=r(12115),o=r(13119),s=r(35299),l=r(71847);let i=(0,l.A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),c=(0,l.A)("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var u=r(90758),d=r(57356),f=r(52619),m=r.n(f);function h(){let{user:e}=(0,o.A)(),[t,r]=(0,a.useState)([]),[l,f]=(0,a.useState)(!0),h=async()=>{try{let t=await fetch("".concat("http://localhost:5000/api","/notifications"),{headers:{Authorization:"Bearer ".concat(null==e?void 0:e.token)}}),n=await t.json();Array.isArray(n)&&r(n)}catch(e){console.error("Failed to fetch notifications")}finally{f(!1)}};(0,a.useEffect)(()=>{(null==e?void 0:e.token)&&h()},[e]);let p=async t=>{try{await fetch("".concat("http://localhost:5000/api","/notifications/").concat(t,"/read"),{method:"PUT",headers:{Authorization:"Bearer ".concat(null==e?void 0:e.token)}}),r(e=>e.map(e=>e._id===t?{...e,isRead:!0}:e))}catch(e){console.error(e)}};return l?(0,n.jsx)("div",{className:"flex h-96 items-center justify-center",children:(0,n.jsx)(s.A,{className:"animate-spin"})}):(0,n.jsxs)("div",{className:"container mx-auto py-8 max-w-2xl",children:[(0,n.jsxs)("h1",{className:"text-3xl font-bold mb-8 flex items-center gap-2",children:[(0,n.jsx)(i,{})," Notifications"]}),(0,n.jsx)("div",{className:"space-y-4",children:0===t.length?(0,n.jsx)("div",{className:"text-center text-gray-500 py-12",children:"No notifications"}):t.map(e=>(0,n.jsx)(u.Zp,{className:"".concat(e.isRead?"bg-white":"bg-blue-50"," transition-colors"),children:(0,n.jsxs)(u.Wu,{className:"p-4 flex gap-4",children:[(0,n.jsx)("div",{className:"w-2 min-w-[8px] rounded-full ".concat(e.isRead?"bg-gray-200":"bg-blue-500")}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"font-semibold",children:e.title}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.message}),(0,n.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-400",children:[(0,n.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString()}),e.link&&(0,n.jsx)(m(),{href:e.link,className:"text-blue-600 hover:underline",children:"View Details"})]})]}),!e.isRead&&(0,n.jsx)(d.$,{variant:"ghost",size:"icon",onClick:()=>p(e._id),title:"Mark as read",children:(0,n.jsx)(c,{className:"w-4 h-4"})})]})},e._id))})]})}},94446:(e,t,r)=>{"use strict";r.d(t,{s:()=>s,t:()=>o});var n=r(12115);function a(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function o(...e){return t=>{let r=!1,n=e.map(e=>{let n=a(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():a(e[t],null)}}}}function s(...e){return n.useCallback(o(...e),e)}}},e=>{e.O(0,[2619,4909,8441,1255,7358],()=>e(e.s=52869)),_N_E=e.O()}]);