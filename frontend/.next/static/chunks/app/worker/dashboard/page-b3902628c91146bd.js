(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1554],{2676:(e,t,s)=>{"use strict";s.d(t,{E1:()=>a,gf:()=>n,q7:()=>i,wz:()=>o});let r="auth_session",a=(e,t)=>{let s={user:{_id:e._id,name:e.name,email:e.email,role:e.role||"user",phone:e.phone,isGoogleUser:e.isGoogleUser,profilePicture:e.profilePicture},token:t,expiresAt:Date.now()+2592e6};localStorage.setItem(r,JSON.stringify(s))},l=()=>{try{let e=localStorage.getItem(r);if(!e)return null;let t=JSON.parse(e);if(t.expiresAt&&Date.now()>t.expiresAt)return i(),null;return t}catch(e){return console.error("Error reading session:",e),null}},n=()=>{let e=l();return(null==e?void 0:e.token)||null},o=()=>{let e=l();return(null==e?void 0:e.user)||null},i=()=>{localStorage.removeItem(r),localStorage.removeItem("user"),localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},13119:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,O:()=>i});var r=s(95155),a=s(12115),l=s(20063),n=s(2676);let o=(0,a.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),i=e=>{let{children:t}=e,[s,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),u=(0,l.useRouter)();(0,a.useEffect)(()=>{let e=(0,n.wz)(),t=(0,n.gf)();e&&t?(console.log("AuthContext: Restoring session. Token present:",!!t),i({...e,token:t})):console.log("AuthContext: No session found in localStorage"),d(!1)},[]);let m=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),r=await s.json();if(!s.ok)throw Error(r.message||"Login failed");return(0,n.E1)(r,r.token),console.log("AuthContext: Login successful. Token:",r.token?"Yes":"No"),i(r),"worker"===r.role?u.push("/worker/dashboard"):"admin"===r.role?u.push("/admin"):u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},h=async(e,t,s,r)=>{try{let a=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,phone:s,password:r})}),l=await a.json();if(!a.ok)throw Error(l.message||"Signup failed");return{success:!0,message:l.message,email:l.email}}catch(e){return{success:!1,message:e.message}}},x=async(e,t)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:t})}),r=await s.json();if(!s.ok)throw Error(r.message||"Verification failed");return(0,n.E1)(r,r.token),console.log("AuthContext: Email verified. Token:",r.token?"Yes":"No"),i(r),u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,r.jsx)(o.Provider,{value:{user:s,setUser:i,loading:c,login:m,register:h,verifyEmail:x,logout:()=>{(0,n.q7)(),i(null),u.push("/login")}},children:t})},c=()=>(0,a.useContext)(o)},16485:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},20063:(e,t,s)=>{"use strict";var r=s(47260);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},20508:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},21873:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},35104:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(95155),a=s(12115),l=s(13119),n=s(35299),o=s(20508),i=s(21873),c=s(16485),d=s(90758);function u(){let{user:e}=(0,l.A)(),[t,s]=(0,a.useState)([]),[u,m]=(0,a.useState)([]),[h,x]=(0,a.useState)(!0),[p,f]=(0,a.useState)("tasks");return((0,a.useEffect)(()=>{let t=async()=>{try{x(!0);let[t,r]=await Promise.all([fetch("".concat("http://localhost:5000/api","/bookings/worker/tasks"),{headers:{Authorization:"Bearer ".concat(null==e?void 0:e.token)}}),fetch("".concat("http://localhost:5000/api","/reviews/worker/").concat(null==e?void 0:e._id))]);if(t.ok){let e=await t.json();s(e)}if(r.ok){let e=await r.json();m(e)}}catch(e){console.error(e)}finally{x(!1)}};(null==e?void 0:e.token)&&t()},[e]),h)?(0,r.jsx)("div",{className:"flex h-96 items-center justify-center",children:(0,r.jsx)(n.A,{className:"animate-spin"})}):(0,r.jsxs)("div",{className:"container mx-auto py-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Worker Dashboard"}),(0,r.jsxs)("div",{className:"flex gap-4 mb-8 border-b",children:[(0,r.jsxs)("button",{onClick:()=>f("tasks"),className:"px-4 py-2 font-semibold ".concat("tasks"===p?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"),children:["My Tasks (",t.length,")"]}),(0,r.jsxs)("button",{onClick:()=>f("reviews"),className:"px-4 py-2 font-semibold ".concat("reviews"===p?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"),children:["Reviews (",u.length,")"]})]}),"tasks"===p&&(0,r.jsx)("div",{children:0===t.length?(0,r.jsx)("div",{className:"text-center text-gray-500 py-12",children:"No tasks assigned yet."}):(0,r.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map(e=>{var t;return(0,r.jsxs)(d.Zp,{className:"hover:shadow-lg transition-shadow",children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(d.ZB,{className:"capitalize",children:e.serviceType}),(0,r.jsx)(d.BT,{children:new Date(e.date).toLocaleDateString()})]}),(0,r.jsxs)(d.Wu,{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(o.A,{className:"w-4 h-4 mt-1 text-gray-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-sm",children:"Customer"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:null==(t=e.user)?void 0:t.name})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(i.A,{className:"w-4 h-4 mt-1 text-gray-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-sm",children:"Location"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.address})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(c.A,{className:"w-4 h-4 mt-1 text-gray-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-sm",children:"Frequency"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.frequency})]})]})]})]},e._id)})})}),"reviews"===p&&(0,r.jsx)("div",{children:0===u.length?(0,r.jsx)("div",{className:"text-center text-gray-500 py-12",children:"No reviews yet."}):(0,r.jsx)("div",{className:"grid gap-6 md:grid-cols-2",children:u.map(e=>{var t;return(0,r.jsxs)(d.Zp,{children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(d.ZB,{className:"text-lg",children:null==(t=e.user)?void 0:t.name}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(Star,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),(0,r.jsx)("span",{className:"font-bold",children:e.rating})]})]}),(0,r.jsx)(d.BT,{children:new Date(e.createdAt).toLocaleDateString()})]}),(0,r.jsx)(d.Wu,{children:(0,r.jsx)("p",{className:"text-gray-700",children:e.comment})})]},e._id)})})})]})}s(18720)},35299:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},54043:(e,t,s)=>{Promise.resolve().then(s.bind(s,35104))},64269:(e,t,s)=>{"use strict";s.d(t,{Y:()=>n,cn:()=>l});var r=s(2821),a=s(75889);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}function n(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}},90758:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>i,Zp:()=>n,aR:()=>o,wL:()=>u});var r=s(95155),a=s(12115),l=s(64269);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...a})});n.displayName="Card";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...a})});o.displayName="CardHeader";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",s),...a})});i.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"}},e=>{e.O(0,[4230,4909,8441,1255,7358],()=>e(e.s=54043)),_N_E=e.O()}]);