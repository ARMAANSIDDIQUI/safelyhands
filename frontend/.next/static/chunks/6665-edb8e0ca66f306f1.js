"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6665],{2676:(e,t,a)=>{a.d(t,{E1:()=>s,gf:()=>n,q7:()=>l,wz:()=>i});let o="auth_session",s=(e,t)=>{let a={user:{_id:e._id,name:e.name,email:e.email,role:e.role||"user",phone:e.phone,isGoogleUser:e.isGoogleUser,profilePicture:e.profilePicture},token:t,expiresAt:Date.now()+2592e6};localStorage.setItem(o,JSON.stringify(a))},r=()=>{try{let e=localStorage.getItem(o);if(!e)return null;let t=JSON.parse(e);if(t.expiresAt&&Date.now()>t.expiresAt)return l(),null;return t}catch(e){return console.error("Error reading session:",e),null}},n=()=>{let e=r();return(null==e?void 0:e.token)||null},i=()=>{let e=r();return(null==e?void 0:e.user)||null},l=()=>{localStorage.removeItem(o),localStorage.removeItem("user"),localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},4179:(e,t,a)=>{a.d(t,{Ay:()=>y,MJ:()=>l,Un:()=>g,WT:()=>n,ZU:()=>r,e8:()=>f,sI:()=>h,t7:()=>d,vH:()=>p});var o=a(26286),s=a(2676);let r=(0,o.zD)("bookings/fetchMyBookings",async(e,t)=>{let{getState:a,rejectWithValue:o}=t;try{let{bookings:e,lastFetch:t}=a().bookings,o=Date.now();if(e.length>0&&t&&o-t<12e4)return e;let r=(0,s.gf)(),n=await fetch("".concat("http://localhost:5000/api","/bookings/mybookings"),{headers:{Authorization:"Bearer ".concat(r)}});if(!n.ok)throw Error("Failed to fetch bookings");return await n.json()}catch(e){return o(e.message)}}),n=(0,o.zD)("bookings/fetchAllBookings",async(e,t)=>{let{getState:a,rejectWithValue:o}=t;try{let{adminBookings:e,lastAdminFetch:t}=a().bookings,o=Date.now();if(e.length>0&&t&&o-t<12e4)return e;let r=(0,s.gf)(),n=await fetch("".concat("http://localhost:5000/api","/bookings"),{headers:{Authorization:"Bearer ".concat(r)}});if(!n.ok)throw Error("Failed to fetch all bookings");return await n.json()}catch(e){return o(e.message)}}),i=(0,o.Z0)({name:"bookings",initialState:{bookings:[],adminBookings:[],currentBooking:null,status:"idle",adminStatus:"idle",error:null,lastFetch:null,lastAdminFetch:null},reducers:{invalidateBookings:e=>{e.status="idle",e.lastFetch=null},invalidateAdminBookings:e=>{e.adminStatus="idle",e.lastAdminFetch=null},setCurrentBooking:(e,t)=>{e.currentBooking=t.payload},removeBookingFromAdmin:(e,t)=>{e.adminBookings=e.adminBookings.filter(e=>e._id!==t.payload)},updateBookingInAdmin:(e,t)=>{let a=e.adminBookings.findIndex(e=>e._id===t.payload._id);-1!==a&&(e.adminBookings[a]=t.payload)}},extraReducers:e=>{e.addCase(r.pending,e=>{e.status="loading"}).addCase(r.fulfilled,(e,t)=>{e.status="succeeded",e.bookings=t.payload,e.lastFetch=Date.now()}).addCase(r.rejected,(e,t)=>{e.status="failed",e.error=t.payload}).addCase(n.pending,e=>{e.adminStatus="loading"}).addCase(n.fulfilled,(e,t)=>{e.adminStatus="succeeded",e.adminBookings=t.payload,e.lastAdminFetch=Date.now()}).addCase(n.rejected,(e,t)=>{e.adminStatus="failed",e.error=t.payload})}}),{invalidateBookings:l,invalidateAdminBookings:d,setCurrentBooking:c,removeBookingFromAdmin:u,updateBookingInAdmin:m}=i.actions,f=e=>e.bookings.bookings,g=e=>e.bookings.adminBookings,h=e=>e.bookings.status,p=e=>e.bookings.adminStatus,y=i.reducer},13119:(e,t,a)=>{a.d(t,{A:()=>d,O:()=>l});var o=a(95155),s=a(12115),r=a(20063),n=a(2676);let i=(0,s.createContext)({user:null,setUser:()=>{},loading:!0,login:async()=>{},register:async()=>{},verifyEmail:async()=>{},logout:()=>{}}),l=e=>{let{children:t}=e,[a,l]=(0,s.useState)(null),[d,c]=(0,s.useState)(!0),u=(0,r.useRouter)();(0,s.useEffect)(()=>{let e=(0,n.wz)(),t=(0,n.gf)();e&&t?(console.log("AuthContext: Restoring session. Token present:",!!t),l({...e,token:t})):console.log("AuthContext: No session found in localStorage"),c(!1)},[]);let m=async(e,t)=>{try{let a=await fetch("".concat("http://localhost:5000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),o=await a.json();if(!a.ok)throw Error(o.message||"Login failed");return(0,n.E1)(o,o.token),console.log("AuthContext: Login successful. Token:",o.token?"Yes":"No"),l(o),"worker"===o.role?u.push("/worker/dashboard"):"admin"===o.role?u.push("/admin"):u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}},f=async(e,t,a,o)=>{try{let s=await fetch("".concat("http://localhost:5000/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,phone:a,password:o})}),r=await s.json();if(!s.ok)throw Error(r.message||"Signup failed");return{success:!0,message:r.message,email:r.email}}catch(e){return{success:!1,message:e.message}}},g=async(e,t)=>{try{let a=await fetch("".concat("http://localhost:5000/api","/auth/verify-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,otp:t})}),o=await a.json();if(!a.ok)throw Error(o.message||"Verification failed");return(0,n.E1)(o,o.token),console.log("AuthContext: Email verified. Token:",o.token?"Yes":"No"),l(o),u.push("/dashboard"),{success:!0}}catch(e){return{success:!1,message:e.message}}};return(0,o.jsx)(i.Provider,{value:{user:a,setUser:l,loading:d,login:m,register:f,verifyEmail:g,logout:()=>{(0,n.q7)(),l(null),u.push("/login")}},children:t})},d=()=>(0,s.useContext)(i)},49094:(e,t,a)=>{a.d(t,{V:()=>y});var o=a(95155),s=a(12115),r=a(75513),n=a(99228),i=a(78674),l=a(88901),d=a(82192),c=a(51321),u=a(87205),m=a(24986),f=a(35405),g=a(47141),h=a(90368),p=a(27937);function y(e){let{selected:t,onSelect:a,disabled:y,modifiers:x,modifiersStyles:b,className:w}=e,[k,v]=(0,s.useState)(new Date),N=(0,i.w)(k),j=(0,l.p)(N),S=(0,d.k)(N),A=(0,c.$)(j),C=(0,u.k)({start:S,end:A});return(0,o.jsxs)("div",{className:"p-4 w-full max-w-sm mx-auto bg-white rounded-lg ".concat(w),children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,o.jsx)("button",{onClick:()=>v((0,n.a)(k,1)),className:"p-1 hover:bg-slate-100 rounded-full transition-colors",children:(0,o.jsx)(h.A,{className:"w-5 h-5 text-slate-600"})}),(0,o.jsx)("div",{className:"font-semibold text-lg text-slate-900",children:(0,m.GP)(k,"MMMM yyyy")}),(0,o.jsx)("button",{onClick:()=>v((0,r.P)(k,1)),className:"p-1 hover:bg-slate-100 rounded-full transition-colors",children:(0,o.jsx)(p.A,{className:"w-5 h-5 text-slate-600"})})]}),(0,o.jsx)("div",{className:"grid grid-cols-7 mb-2 text-center",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(e=>(0,o.jsx)("div",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide py-1",children:e},e))}),(0,o.jsx)("div",{className:"grid grid-cols-7 gap-1 place-items-center",children:C.map((e,s)=>{let r=y&&y(e),n=t&&(0,f.r)(e,t),i=(0,f.r)(e,new Date),l=(0,g.t)(e,k),d={};if(x&&b)for(let t in x)x[t](e)&&(d={...d,...b[t]});return(0,o.jsx)("button",{onClick:()=>!r&&a&&a(e),disabled:r,style:d,className:"\n                                w-9 h-9 flex items-center justify-center rounded-lg text-sm transition-all relative\n                                ".concat(!l?"text-slate-300":"text-slate-700","\n                                ").concat(n?"ring-2 ring-primary ring-offset-1 z-10":"","\n                                ").concat(!n&&i&&!d.backgroundColor?"bg-slate-100 font-semibold":"","\n                                ").concat(!r&&!n?"hover:bg-slate-50":"","\n                                ").concat(r?"opacity-40 cursor-not-allowed text-slate-300":"","\n                            "),children:(0,m.GP)(e,"d")},e.toString())})})]})}},57356:(e,t,a)=>{a.d(t,{$:()=>d});var o=a(95155),s=a(12115),r=a(32467),n=a(83101),i=a(64269);let l=(0,n.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:n,asChild:d=!1,...c}=e,u=d?r.DX:"button";return(0,o.jsx)(u,{className:(0,i.cn)(l({variant:s,size:n,className:a})),ref:t,...c})});d.displayName="Button"},64269:(e,t,a)=>{a.d(t,{Y:()=>n,cn:()=>r});var o=a(2821),s=a(75889);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,o.$)(t))}function n(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}},83416:(e,t,a)=>{a.d(t,{bq:()=>m,eb:()=>p,gC:()=>h,l6:()=>c,yv:()=>u});var o=a(95155),s=a(12115),r=a(63350),n=a(24033),i=a(12108),l=a(5917),d=a(64269);let c=r.bL;r.YJ;let u=r.WT,m=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,o.jsxs)(r.l9,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[s,(0,o.jsx)(r.In,{asChild:!0,children:(0,o.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=r.l9.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,o.jsx)(r.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,o.jsx)(i.A,{className:"h-4 w-4"})})});f.displayName=r.PP.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,o.jsx)(r.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,o.jsx)(n.A,{className:"h-4 w-4"})})});g.displayName=r.wn.displayName;let h=s.forwardRef((e,t)=>{let{className:a,children:s,position:n="popper",...i}=e;return(0,o.jsx)(r.ZL,{children:(0,o.jsxs)(r.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...i,children:[(0,o.jsx)(f,{}),(0,o.jsx)(r.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-content-available-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,o.jsx)(g,{})]})})});h.displayName=r.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,o.jsx)(r.JU,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=r.JU.displayName;let p=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,o.jsxs)(r.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,o.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,o.jsx)(r.VF,{children:(0,o.jsx)(l.A,{className:"h-4 w-4"})})}),(0,o.jsx)(r.p4,{children:s})]})});p.displayName=r.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,o.jsx)(r.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=r.wv.displayName},92216:(e,t,a)=>{a.d(t,{G:()=>r,j:()=>s});var o=a(1213);let s=()=>(0,o.wA)(),r=o.d4}}]);